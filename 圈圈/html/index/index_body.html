<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<!--确保绘制和缩放的效果需要在<head>标签中添加 viewport 元数据标签-->
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
		<title>主body</title>
		<!--引入aui框架win-->
		<link rel="stylesheet" href="../../css/aui.css" />
		<link rel="stylesheet" href="../../css/fonts/iconfont.css" />
		<link rel="stylesheet" href="../../css/swiper/swiper.min.css" />
		<style>
			.aui-bg-ff3366 {
				background: #ff3366;
			}
			.aui-bg-ffc80a {
				background: #ffc80a;
			}
			.aui-bg-33cccc {
				background: #33cccc;
			}
			.aui-bg-cc99cc {
				background: #cc99cc;
			}
			.aui-color-bbb {
				color: #bbb !important;
			}
			.func-menu {
				height: 90px;
				background: #fff;
				margin-bottom: 10px;
				box-shadow: inset 0 1px 0 #FFFFFF, 0 3px 5px rgba(236, 236, 236, 0.2);
				border-bottom: 1px solid #E4E4E4;
			}
			.item-func {
				float: left;
				width: 25%;
				display: -webkit-box;
				-webkit-box-orient: horizontal;
				-webkit-box-pack: center;
				-webkit-box-align: center;
				display: box;
				box-orient: horizontal;
				box-pack: center;
				box-align: center;
				padding: 10px 0 10px 0;
			}
			.item-func p {
				height: 47px;
				width: 47px;
				display: -webkit-box;
				-webkit-box-orient: horizontal;
				-webkit-box-pack: center;
				-webkit-box-align: center;
				display: box;
				box-orient: horizontal;
				box-pack: center;
				box-align: center;
				border-radius: 37%;
				-webkit-border-radius: 37%;
				margin: 0 auto;
			}
			.item-func p i {
				color: #fff;
				font-size: 28px;
			}
			.item-func span {
				display: block;
				padding: 5px 0 0 0;
				font-size: 14px;
				color: #666;
				text-align: center
			}
			.item-func:active {
				background: #f4f4f4;
			}
			.swiper-container {
				width: 100%;
				height: 100px;
			}
			.swiper-container .swiper-slide {
				background-position: center;
				background-size: cover;
				-webkit-background-size: cover;
			}
			.banner-container .swiper-pagination {
				bottom: 0;
			}
			.swiper-pagination-bullet-active {
				background: #fefb62
			}
			.swiper-container-horizontal > .swiper-pagination {
				bottom: 2px;
			}
			.twkb {
				padding: 11px 20px;
				margin-top: 10px;
				border-top: 1px solid #e0e0e0;
				background: #fff;
				box-shadow: inset 0 1px 0 #FFFFFF, 0 3px 5px rgba(236, 236, 236, 0.2);
				border-bottom: 1px solid #E4E4E4;
				margin-bottom: 10px;
			}
			.index_more {
				font-size: 12px;
				background: #da6bc9;
				color: #fff;
				padding: 2px 6px;
				border-radius: 8px;
			}
			.index_hb a {
				color: #555555
			}
			.dian_0 {
				width: 9px;
				height: 9px;
				background: #ff5b1c;
				float: left;
				margin-top: 8px;
				margin-right: 6px;
				border-radius: 3px;
			}
			.dian_1 {
				width: 9px;
				height: 9px;
				background: #ffc80a;
				float: left;
				margin-top: 8px;
				margin-right: 6px;
				border-radius: 3px;
			}
			.dian_2 {
				width: 9px;
				height: 9px;
				background: #5acace;
				float: left;
				margin-top: 8px;
				margin-right: 6px;
				border-radius: 3px;
			}
			.twkb2 {
				padding-top: 11px;
				padding-left: 5px;
				padding-right: 5px;
				margin-top: 10px;
				border-top: 1px solid #e0e0e0;
				background: #fff;
				box-shadow: inset 0 1px 0 #FFFFFF, 0 3px 5px rgba(236, 236, 236, 0.2);
				margin-bottom: 0
			}
			.slider {
				margin-bottom: 0;
			}
			.slider img {
				width: 100%;
				height: 120px;
				display: inherit;
			}
			.aui-grid-sixteen:after {
				border: none;
			}
			.aui-grid-sixteen li:after {
				border: none;
			}
			.aui-grid-sixteen li .aui-iconfont {
				color: #ffffff;
				width: 38px;
				height: 38px;
				line-height: 38px;
				border-radius: 50%;
				font-size: 20px;
			}
			p.goods-title {
				font-size: 1em;
				color: #333;
			}
			p.goods-info {
				font-size: 12px;
				color: #999;
			}
			.aui-line-x {
				margin: 5px 0;
			}
			.aui-line-x:after {
				border-color: #ddd;
			}
			.goods-price {
				font-size: 0.875em;
			}
			.goods-price strong {
				margin: 0 5px;
				font-size: 16px;
			}
			.shop_title {
				height: 42px;
				overflow: hidden;
			}
		</style>
	</head>
	<body>
		<!--首页广告幻灯开始-->
		<div class="swiper-container">
			<div class="swiper-wrapper" id="index_addata_body"></div>
			<!-- 如果需要分页器 -->
			<div class="swiper-pagination"></div>
		</div>
		<script id="index_addata" type="text/html">
			{{# for(var i = 0, len = d.retValue.length; i < len; i++){ }}
			<div class="swiper-slide" style="background-image:url(http://q.endzk.com/{{ d.retValue[i].content }})"></div>
			{{# } }}
		</script>
		<!--首页广告幻灯结束-->
		<!--首页菜单开始-->
		<div class="func-menu">
			<!--诊疗-->
			<div class="item-func" id="consulting_header" tapmode>
				<div class="content-area">
					<p class="aui-bg-ff3366">
						<i class="iconfont icon-shenfenrenzheng"></i>
					</p>
					<span>诊疗</span>
				</div>
			</div>
			<!--诊疗-->
			<!--问答-->
			<div class="item-func" id="answers_header" tapmode>
				<div class="content-area">
					<p class="aui-bg-ffc80a">
						<i class="iconfont icon-wenda"></i>
					</p>
					<span>问答</span>
				</div>
			</div>
			<!--问答-->
			<!--位置-->
			<div class="item-func" id="position_header" tapmode >
				<div class="content-area">
					<p class="aui-bg-33cccc">
						<i class="iconfont icon-weizhi"></i>
					</p>
					<span>位置</span>
				</div>
			</div>
			<!--位置-->
			<!--身份-->
			<div class="item-func" id="identity_header" tapmode >
				<div class="content-area">
					<p class="aui-bg-cc99cc">
						<i class="iconfont icon-shenfenrenzheng1"></i>
					</p>
					<span>身份</span>
				</div>
			</div>
			<!--身份-->
		</div>
		<!--首页菜单结束-->
		<div class="aui-content twkb">
			<div style="height:27px">
				<div class="aui-col-xs-6"><img src="../../image/mckb.png" style="height:20px;"/>
				</div>
				<div class="aui-col-xs-6" style="text-align: right;">
					<span class="index_more">更多内容</span>
				</div>
			</div>
			<div class="index_hb">
				<ul>
					<li>
						<span class="dian_0"></span><a href="#">新用户首单立减20元（在线支付）</a>
					</li>
					<li>
						<span class="dian_1"></span><a href="#">在线支付满50减15</a>
					</li>
					<li>
						<span class="dian_2"></span><a href="#">1000积分换购项圈活动即将开始</a>
					</li>
				</ul>
			</div>
		</div>
		<div class="aui-content twkb2">
			<div><img src="../../image/jrjx.png" style="height: 20px;margin-left: 15px" />
			</div>
			<ul class="aui-list-view aui-grid-view" id="index_shopdata_body"></ul>
		</div>
		<script id="index_shopdata" type="text/html">
			{{# for(var i = 0, len = d.retValue.length; i < len; i++){ }}
			<li class="aui-list-view-cell aui-img aui-col-xs-6" tapmode onclick="openGoods()">
			<img class="aui-img-object" src="http://q.endzk.com/{{ d.retValue[i].img }}">
			<div class="aui-img-body aui-text-left">
			<div class="shop_title">{{ d.retValue[i].name }}</div>
			<p>
			<span class="goods-price aui-text-danger">¥<strong>{{ d.retValue[i].sell_price }}</strong>元</span>
			</p>
			<p class="goods-info">
			<span class="aui-text-danger">{{ d.retValue[i].favorite }}</span>人收藏
			</p>
			</div>
			</li>
			{{# } }}
		</script>
	</body>
	<!--封装了APICloud大量常用的类库，内置了DOM操作，模板引擎，表单验证等常用类库-->
	<script type="text/javascript" src="../../script/AHelper.js"></script>
	<script type="text/javascript" src="../../script/zepto.min.js"></script>
	<script type="text/javascript" src="../../script/swiper/swiper.min.js"></script>
	<script type="text/javascript" src="../../script/echo.min.js"></script>
	<script type="text/javascript" src="../../script/laytpl.js"></script>
	<script type="text/javascript">
		//图片y
		Zepto(function() {
			/*窗口打开处理 ok*/
			$("#position_header").on("click", function() {
				api.parseTapmode();
				H.$openWin("position_header", "../pet/position_header.html");
			});
			/*更多活动处理*/
			$(".index_more").on("click", function() {
				api.parseTapmode();
				H.$openWin("moreActivity_header", "moreActivity_header.html");
			});
			/*诊疗处理*/
			$("#consulting_header").on("click", function() {
				api.parseTapmode();
				H.$openWin("consulting_header", "../friend/consulting_header.html");
			});
			/*问答处理*/
			$("#answers_header").on("tap", function() {
				api.parseTapmode();
				H.$openWin("answers_header", "../friend/answers_header.html");
			});
			/*身份处理*/
			$("#identity_header").on("tap", function() {
				var FNScanner = api.require('FNScanner');
				FNScanner.openScanner({
					autorotation : true,
				}, function(ret, err) {
					if (ret) {
						//alert( JSON.stringify( ret ) );
					} else {
						//alert( JSON.stringify( err ) );
					}
				});
			});
		});
		//所有的代码都写在H.ready(function(){})
		H.ready(function() {
			//获取个人认证token
			api.getPrefs({
				key : 'userinfo'
			}, function(ret, err) {
				//字符串转为json对象
				var retobj = eval('(' + ret.value + ')');
				//请求首页广告数据
				api.ajax({
					url : 'http://q.endzk.com/apis/app_index_manage/token/' + retobj.token
				}, function(ret, err) {
					var tpl = document.getElementById('index_addata').innerHTML;
					laytpl(tpl).render(ret, function(render) {
						document.getElementById('index_addata_body').innerHTML = render;
						var mySwiper = new Swiper('.swiper-container', {
							loop : true,
							// 如果需要分页器
							pagination : '.swiper-pagination',
							autoplay : 3000
						});
					});
				});
				//请求首页精选数据
				api.ajax({
					url : 'http://q.endzk.com/apis/app_index_commend/token/' + retobj.token
				}, function(ret, err) {
					// 获取模板内容，并加载数据
					var tpl = document.getElementById('index_shopdata').innerHTML;
					//读取模版
					laytpl(tpl).render(ret, function(render) {
						document.getElementById('index_shopdata_body').innerHTML = render;
					});
				});
			});
			/*下拉刷新*/
			H.$dropdownToRefresh(function(ret, err) {
				setTimeout(function() {
					H.$recoverDropdownToNormal();
				}, 1000);
			});
		});
		function openGoods() {
			H.$toast("商品内容");
		}

		/*
		 * 获取首页数据函数
		 */
		function getdata() {
		}
	</script>
</html>