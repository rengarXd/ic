<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
		<link rel="stylesheet" type="text/css" href="../../css/aui.css" />
		<style type="text/css">
			.slider {
				margin-bottom: 0;
			}
			.slider img {
				width: 100%;
				height: 120px;
				display: inherit;
			}
			.aui-grid-sixteen:after {
				border: none;
			}
			.aui-grid-sixteen li:after {
				border: none;
			}
			.aui-grid-sixteen li .aui-iconfont {
				color: #ffffff;
				width: 38px;
				height: 38px;
				line-height: 38px;
				border-radius: 50%;
				font-size: 20px;
			}
			p.goods-title {
				font-size: 1em;
				color: #333;
			}
			p.goods-info {
				font-size: 12px;
				color: #999;
			}
			.aui-line-x {
				margin: 5px 0;
			}
			.aui-line-x:after {
				border-color: #ddd;
			}
			.goods-price {
				font-size: 0.875em;
			}
			.goods-price strong {
				margin: 0 5px;
				font-size: 16px;
			}
		</style>
	</head>
	<body>
		<div class="aui-content slider">
			<img src="../../image/d5.png" />
		</div>
		<div class="aui-content">
			<ul class="aui-grid-sixteen">
				<li class="aui-col-xs-3 aui-text-center">
					<span class="aui-iconfont aui-icon-profilefill aui-bg-success"></span>
					<p>
						全部商品
					</p>
				</li>
				<li class="aui-col-xs-3 aui-text-center">
					<span class="aui-iconfont aui-icon-creativefill aui-bg-warning"></span>
					<p>
						积分兑换
					</p>
				</li>
				<li class="aui-col-xs-3 aui-text-center">
					<span class="aui-iconfont aui-icon-apps aui-bg-danger"></span>
					<p>
						新品促销
					</p>
				</li>
				<li class="aui-col-xs-3 aui-text-center">
					<span class="aui-iconfont aui-icon-countdownfill aui-bg-info"></span>
					<p>
						热门推荐
					</p>
				</li>
			</ul>
		</div>
		<div class="aui-content">
			<ul class="aui-list-view aui-grid-view" id="shopdata_body"></ul>
		</div>
		<script type="text/html" id="shopdata">
			{{# for(var i = 0, len = d.retValue.length; i < len; i++){ }}
			<li class="aui-list-view-cell aui-img aui-col-xs-6" id="{{ d.retValue[i].id }}" tapmode onclick="openGoods()">
					<img class="aui-img-object" src="http://q.endzk.com/{{ d.retValue[i].img }}">
					<div class="aui-img-body aui-text-left">
						{{ d.retValue[i].name }}
						<p>
							<span class="goods-price aui-text-danger">¥<strong>{{ d.retValue[i].sell_price }}</strong>元</span>
						</p>
						<p class="goods-info">
							共售出<span class="aui-text-danger">{{ d.retValue[i].sale }}</span>件
						</p>
					</div>
				</li>
			{{# } }}
		</script>
	</body>
	<script type="text/javascript" src="../../script/AHelper.js"></script>
	<script type="text/javascript" src="../../script/laytpl.js"></script>
	<script type="text/javascript">
		H.ready(function() {
			api.parseTapmode();
			api.getPrefs({
	            key:'userinfo'
            },function(ret,err){
            	var retobj = eval('('+ret.value+')');
            	
            	api.ajax({
	                url:window.serverUrl + '/goods_list/token/' + retobj.token+ '/user_id/' + retobj.id 
                },function(ret,err){
                	if(ret && ret.retCode == 1){
//              		alert(JSON.stringify(ret.retValue))
                		var tpl = document.getElementById('shopdata').innerHTML;
						//读取模版
						laytpl(tpl).render(ret, function(render) {
							H.$recoverDropdownToNormal();
							document.getElementById('shopdata_body').innerHTML = render;
						});
                	}else{
                		api.$toast({
	                        msg:'非法请求！'
                        });
                	}
                });
            });
		});
		function openGoods() {
			var delay = 0;
			if (api.systemType != 'ios') {
				delay = 300;
			}
			//      api.openWin({
			//          name: 'goods_show_win',
			//          url: 'goods_show_win.html',
			//          bounces: false,
			//          delay:delay
			//      });
		}
	</script>
</html>